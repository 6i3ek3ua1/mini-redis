# Тест-кейсы для mini-redis

## 1. Базовые команды
- **SET/GET (позитив)**  
  Шаги: SET a 1 → GET a.  
  Ожидание: SET → 1; GET → "1".
- **GET отсутствующего ключа**  
  Шаги: GET no_such_key.  
  Ожидание: nil.
- **DELETE (существует/не существует)**  
  Шаги: SET x 1 → DELETE x → DELETE x.  
  Ожидание: 1, затем 0.
- **FLUSH очищает хранилище**  
  Шаги: MSET a 1 b 2 → FLUSH → GET a.  
  Ожидание: FLUSH ≥ 1; GET a → nil.
- **MSET/MGET**  
  Шаги: MSET k1 v1 k2 v2 → MGET k1 k2 oops.  
  Ожидание: 2; ["v1", "v2", nil].
- **Валидация MSET**  
  Шаги: MSET k1 v1 k2.  
  Ожидание: ошибка (-ERR), клиент кидает исключение.

## 2. TTL
- **EXPIRE/TTL/истечение**  
  Шаги: SET t v → EXPIRE t 1 → TTL t → подождать >1с → GET t → TTL t.  
  Ожидание: TTL ∈ {1,0}; GET → nil; TTL → -2.
- **TTL без EXPIRE**  
  Шаги: SET a 1 → TTL a.  
  Ожидание: -1.
- **DEFAULTTTL через ENV**  
  Шаги: старт сервера с MINIREDIS_DEFAULT_TTL=1 → SET b 2 → TTL b → подождать >1с → GET b.  
  Ожидание: TTL ∈ {1,0}; затем nil.
- **EXPIRE неверный формат**  
  Шаги: EXPIRE x not_a_number.  
  Ожидание: ошибка (-ERR).

## 3. Ошибки протокола/команд
- **Неизвестная команда**  
  Шаги: BOGUS.  
  Ожидание: -ERR bad request / Unrecognized command.
- **Пустой массив аргументов**  
  Шаги: отправить пустой массив.  
  Ожидание: -ERR Missing command.

## 4. Конкурентность (smoke)
- **Параллельные SET**  
  Шаги: 20 потоков пишут k{i}=v{i}; затем MGET всех ключей.  
  Ожидание: значения согласованные, без гонок.

## Замечания по рискам
- Грани TTL (округление, задержка 1с) учитываются допуском TTL ∈ {1,0}.
- Очистка: ленивая + фоновая — поэтому проверки истечения допускают время на reaper.
- RESP-совместимость проверяется косвенно (round-trip в unit-тесте).
